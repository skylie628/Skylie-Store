{"version":3,"file":"authValide.js","names":["_require","require","body","validateRegister","not","isEmpty","bail","isLength","max","withMessage","isEmail","min","custom","value","_ref","req","password","validateLogin","authValidate","exports"],"sources":["../../src/validators/authValide.js"],"sourcesContent":["const {body} = require('express-validator');\r\n\r\nconst validateRegister = () => {\r\n  return [ \r\n    body('firstname', 'Firstname không được để trống').not().isEmpty()\r\n    .bail().isLength({ max: 100 }).withMessage(\"Firstname không nhiều hơn 100 ký tự\"),\r\n\r\n    body('lastname', 'Lastname không được để trống').not().isEmpty()\r\n    .bail().isLength({ max: 100 }).withMessage(\"Lastname không nhiều hơn 100 ký tự\"),\r\n\r\n    body('email').not().isEmpty().withMessage('Email không được để trống ')\r\n    .bail().isEmail().withMessage(\"Email không đúng định dạng\")\r\n    .bail().isLength({ max: 320 }).withMessage(\"Email không nhiều hơn 320 ký tự\"),\r\n\r\n    body('password').not().isEmpty().withMessage('Password không được để trống')\r\n    .bail().isLength({ min: 6 }).withMessage('Password phải nhiều hơn 6 ký tự')\r\n    .bail().isLength({ max: 320 }).withMessage(\"Password không nhiều hơn 320 ký tự\"),\r\n\r\n    body('confirmpassword').not().isEmpty().withMessage('Confirm password không được để trống')\r\n    .bail().custom((value, { req }) => {\r\n        if (value === req.body.password) {\r\n          return true;\r\n        }\r\n        return false;\r\n      })\r\n      .withMessage(\"Confirm password phải giống password\")\r\n  ] \r\n}\r\n\r\nconst validateLogin = () => {\r\n  return [ \r\n    body('email')\r\n    .not()\r\n    .isEmpty()\r\n    .withMessage('Email không được để trống')\r\n    .bail()\r\n    .isEmail()\r\n    .withMessage('Email không đúng định dạng'),\r\n\r\n    body('password')\r\n    .not()\r\n    .isEmpty()\r\n    .withMessage('Password không được để trống')\r\n    .bail()\r\n    .isLength({ min: 6 })\r\n    .withMessage('Password phải nhiều hơn 6 ký tự')\r\n  ]; \r\n}\r\n\r\nexport const authValidate = {\r\n  validateRegister,\r\n  validateLogin\r\n};\r\n\r\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAeC,OAAO,CAAC,mBAAmB,CAAC;EAApCC,IAAI,GAAAF,QAAA,CAAJE,IAAI;AAEX,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgBA,CAAA,EAAS;EAC7B,OAAO,CACLD,IAAI,CAAC,WAAW,EAAE,+BAA+B,CAAC,CAACE,GAAG,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CACjEC,IAAI,CAAC,CAAC,CAACC,QAAQ,CAAC;IAAEC,GAAG,EAAE;EAAI,CAAC,CAAC,CAACC,WAAW,CAAC,qCAAqC,CAAC,EAEjFP,IAAI,CAAC,UAAU,EAAE,8BAA8B,CAAC,CAACE,GAAG,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAC/DC,IAAI,CAAC,CAAC,CAACC,QAAQ,CAAC;IAAEC,GAAG,EAAE;EAAI,CAAC,CAAC,CAACC,WAAW,CAAC,oCAAoC,CAAC,EAEhFP,IAAI,CAAC,OAAO,CAAC,CAACE,GAAG,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAACI,WAAW,CAAC,4BAA4B,CAAC,CACtEH,IAAI,CAAC,CAAC,CAACI,OAAO,CAAC,CAAC,CAACD,WAAW,CAAC,4BAA4B,CAAC,CAC1DH,IAAI,CAAC,CAAC,CAACC,QAAQ,CAAC;IAAEC,GAAG,EAAE;EAAI,CAAC,CAAC,CAACC,WAAW,CAAC,iCAAiC,CAAC,EAE7EP,IAAI,CAAC,UAAU,CAAC,CAACE,GAAG,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAACI,WAAW,CAAC,8BAA8B,CAAC,CAC3EH,IAAI,CAAC,CAAC,CAACC,QAAQ,CAAC;IAAEI,GAAG,EAAE;EAAE,CAAC,CAAC,CAACF,WAAW,CAAC,iCAAiC,CAAC,CAC1EH,IAAI,CAAC,CAAC,CAACC,QAAQ,CAAC;IAAEC,GAAG,EAAE;EAAI,CAAC,CAAC,CAACC,WAAW,CAAC,oCAAoC,CAAC,EAEhFP,IAAI,CAAC,iBAAiB,CAAC,CAACE,GAAG,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAACI,WAAW,CAAC,sCAAsC,CAAC,CAC1FH,IAAI,CAAC,CAAC,CAACM,MAAM,CAAC,UAACC,KAAK,EAAAC,IAAA,EAAc;IAAA,IAAVC,GAAG,GAAAD,IAAA,CAAHC,GAAG;IACxB,IAAIF,KAAK,KAAKE,GAAG,CAACb,IAAI,CAACc,QAAQ,EAAE;MAC/B,OAAO,IAAI;IACb;IACA,OAAO,KAAK;EACd,CAAC,CAAC,CACDP,WAAW,CAAC,sCAAsC,CAAC,CACvD;AACH,CAAC;AAED,IAAMQ,aAAa,GAAG,SAAhBA,aAAaA,CAAA,EAAS;EAC1B,OAAO,CACLf,IAAI,CAAC,OAAO,CAAC,CACZE,GAAG,CAAC,CAAC,CACLC,OAAO,CAAC,CAAC,CACTI,WAAW,CAAC,2BAA2B,CAAC,CACxCH,IAAI,CAAC,CAAC,CACNI,OAAO,CAAC,CAAC,CACTD,WAAW,CAAC,4BAA4B,CAAC,EAE1CP,IAAI,CAAC,UAAU,CAAC,CACfE,GAAG,CAAC,CAAC,CACLC,OAAO,CAAC,CAAC,CACTI,WAAW,CAAC,8BAA8B,CAAC,CAC3CH,IAAI,CAAC,CAAC,CACNC,QAAQ,CAAC;IAAEI,GAAG,EAAE;EAAE,CAAC,CAAC,CACpBF,WAAW,CAAC,iCAAiC,CAAC,CAChD;AACH,CAAC;AAEM,IAAMS,YAAY,GAAG;EAC1Bf,gBAAgB,EAAhBA,gBAAgB;EAChBc,aAAa,EAAbA;AACF,CAAC;AAACE,OAAA,CAAAD,YAAA,GAAAA,YAAA"}